---
phase: 07-gap-closure-link-integrity
plan: 03
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - apps/web/src/app/hogskoleprovet/[slug]/page.tsx
  - apps/web/src/components/navigation/recent-tests.tsx
  - apps/web/src/app/hogskoleprovet/strategier/kvantitativa-fallor/page.tsx
  - apps/web/src/app/hogskoleprovet/strategier/verbala-fallor/page.tsx
  - apps/web/src/app/hogskoleprovet/strategier/vanliga-misstag/page.tsx
  - apps/web/src/app/hogskoleprovet/strategier/tidsstrategi/page.tsx
autonomous: true

must_haves:
  truths:
    - "Test detail pages link to all 4 strategy content pages"
    - "Strategy pages link to 4 specific recent tests, not just generic /hogskoleprovet"
    - "All new links resolve to live pages (zero 404s)"
  artifacts:
    - path: "apps/web/src/app/hogskoleprovet/[slug]/page.tsx"
      provides: "Strategy links section after RelatedTests"
      contains: "Lär dig strategier"
    - path: "apps/web/src/components/navigation/recent-tests.tsx"
      provides: "Reusable RecentTests component for strategy pages"
      exports: ["RecentTests"]
    - path: "apps/web/src/app/hogskoleprovet/strategier/kvantitativa-fallor/page.tsx"
      provides: "Strategy page with specific test links"
      contains: "RecentTests"
  key_links:
    - from: "hogskoleprovet/[slug]/page.tsx"
      to: "strategier/* pages"
      via: "Link components in strategy section"
      pattern: "hogskoleprovet/strategier/"
    - from: "strategier/*/page.tsx"
      to: "hogskoleprovet/[slug] pages"
      via: "RecentTests component"
      pattern: "hogskoleprovet/.*slug"
---

<objective>
Implement bidirectional linking between test pages and strategy content (LINK-01 and LINK-02).

Purpose: Users on test pages can discover strategy content to improve their scores, and users reading strategies can jump to specific practice tests. Closes the navigation gap that keeps these two content types siloed.

Output: Test pages have a "Lär dig strategier" section with links to all 4 strategy pages. Strategy pages replace generic CTA with RecentTests component showing 4 most recent tests.
</objective>

<execution_context>
@/Users/williamlarsten/.claude/get-shit-done/workflows/execute-plan.md
@/Users/williamlarsten/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/web/src/app/hogskoleprovet/[slug]/page.tsx
@apps/web/src/components/navigation/related-tests.tsx
@apps/web/src/app/hogskoleprovet/strategier/kvantitativa-fallor/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add strategy links to test detail pages (LINK-01)</name>
  <files>apps/web/src/app/hogskoleprovet/[slug]/page.tsx</files>
  <action>
    Edit `apps/web/src/app/hogskoleprovet/[slug]/page.tsx` to add a "Lär dig strategier" section AFTER the `<RelatedTests currentTest={test} />` component (line 170) and BEFORE the closing `</div>` of the main content area.

    Add this section:
    ```tsx
    {/* Strategy content links */}
    <section className="mt-16 pt-8 border-t border-border">
      <h2 className="text-xl font-bold text-foreground mb-4">
        Lär dig strategier
      </h2>
      <p className="text-foreground-muted mb-6">
        Förbättra ditt resultat genom att lära dig känna igen vanliga fällor och optimera din tidsplanering.
      </p>
      <div className="grid gap-3">
        <Link
          href="/hogskoleprovet/strategier/kvantitativa-fallor"
          className="flex items-center justify-between p-4 bg-card-background rounded-xl border-2 border-border hover:border-primary transition-colors group"
        >
          <span className="font-semibold text-foreground group-hover:text-primary transition-colors">
            Kvantitativa fällor
          </span>
          <span className="text-foreground-muted group-hover:text-primary">→</span>
        </Link>
        <Link
          href="/hogskoleprovet/strategier/verbala-fallor"
          className="flex items-center justify-between p-4 bg-card-background rounded-xl border-2 border-border hover:border-primary transition-colors group"
        >
          <span className="font-semibold text-foreground group-hover:text-primary transition-colors">
            Verbala fällor
          </span>
          <span className="text-foreground-muted group-hover:text-primary">→</span>
        </Link>
        <Link
          href="/hogskoleprovet/strategier/vanliga-misstag"
          className="flex items-center justify-between p-4 bg-card-background rounded-xl border-2 border-border hover:border-primary transition-colors group"
        >
          <span className="font-semibold text-foreground group-hover:text-primary transition-colors">
            Vanliga misstag
          </span>
          <span className="text-foreground-muted group-hover:text-primary">→</span>
        </Link>
        <Link
          href="/hogskoleprovet/strategier/tidsstrategi"
          className="flex items-center justify-between p-4 bg-card-background rounded-xl border-2 border-border hover:border-primary transition-colors group"
        >
          <span className="font-semibold text-foreground group-hover:text-primary transition-colors">
            Tidsstrategi
          </span>
          <span className="text-foreground-muted group-hover:text-primary">→</span>
        </Link>
      </div>
    </section>
    ```

    The styling matches the existing RelatedTests component pattern: card-background, border-2 border-border, hover:border-primary, group hover effects.

    Note: `Link` is already imported at line 1.
  </action>
  <verify>
    Run the dev server, visit `/hogskoleprovet/hosten-2025`, scroll to bottom. Verify "Lär dig strategier" section appears after "Fler högskoleprov" with 4 strategy links. Click each link to confirm navigation.
  </verify>
  <done>
    Every test detail page displays 4 strategy links after the related tests section.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create RecentTests component and update strategy pages (LINK-02)</name>
  <files>
    apps/web/src/components/navigation/recent-tests.tsx
    apps/web/src/app/hogskoleprovet/strategier/kvantitativa-fallor/page.tsx
    apps/web/src/app/hogskoleprovet/strategier/verbala-fallor/page.tsx
    apps/web/src/app/hogskoleprovet/strategier/vanliga-misstag/page.tsx
    apps/web/src/app/hogskoleprovet/strategier/tidsstrategi/page.tsx
  </files>
  <action>
    **Step 1: Create RecentTests component**

    Create `apps/web/src/components/navigation/recent-tests.tsx`:
    ```tsx
    import Link from "next/link";
    import { tests } from "@/data/tests";

    interface RecentTestsProps {
      count?: number;
    }

    export function RecentTests({ count = 4 }: RecentTestsProps) {
      const recentTests = tests.slice(0, count);

      return (
        <section className="pt-8 border-t border-border">
          <h2 className="text-2xl font-bold text-foreground mb-2">
            Öva med gamla prov
          </h2>
          <p className="text-foreground-muted mb-6">
            Nu när du känner till strategierna – testa dem på riktiga högskoleprov.
          </p>
          <div className="grid gap-3">
            {recentTests.map((test) => {
              const seasonLabel = test.season === "vår" ? "Våren" : "Hösten";
              return (
                <Link
                  key={test.id}
                  href={`/hogskoleprovet/${test.slug}`}
                  className="flex items-center justify-between p-4 bg-card-background rounded-xl border-2 border-border hover:border-primary transition-colors group"
                >
                  <span className="font-semibold text-foreground group-hover:text-primary transition-colors">
                    {seasonLabel} {test.year}
                  </span>
                  <span className="text-foreground-muted group-hover:text-primary">
                    →
                  </span>
                </Link>
              );
            })}
          </div>
          <Link
            href="/hogskoleprovet"
            className="block mt-4 text-primary hover:underline text-center"
          >
            Se alla prov →
          </Link>
        </section>
      );
    }
    ```

    This follows the exact same card styling as `related-tests.tsx` for visual consistency.

    **Step 2: Update all 4 strategy pages**

    In each of the 4 strategy page files, make two changes:

    a) Add import at top of file:
    ```tsx
    import { RecentTests } from "@/components/navigation/recent-tests";
    ```

    b) Replace the existing CTA section at the bottom of each page. Find the section that contains the generic link to `/hogskoleprovet`:
    ```tsx
    <section className="pt-8 border-t border-border">
      <h2 ...>Öva med gamla prov</h2>
      <p ...>Nu när du känner till strategierna – testa dem på riktiga högskoleprov.</p>
      <Link href="/hogskoleprovet" ...>
        <h3>Gamla högskoleprov</h3>
        <p>Provfrågor, facit och normering från 2013 till idag</p>
      </Link>
    </section>
    ```

    Replace that entire section with:
    ```tsx
    <RecentTests count={4} />
    ```

    Apply to all 4 files:
    - `apps/web/src/app/hogskoleprovet/strategier/kvantitativa-fallor/page.tsx`
    - `apps/web/src/app/hogskoleprovet/strategier/verbala-fallor/page.tsx`
    - `apps/web/src/app/hogskoleprovet/strategier/vanliga-misstag/page.tsx`
    - `apps/web/src/app/hogskoleprovet/strategier/tidsstrategi/page.tsx`

    After replacing, you may be able to remove the `Link` import from `next/link` if it is no longer used elsewhere in the file. Check each file individually — if other Links exist in the page, keep the import.
  </action>
  <verify>
    1. Visit `/hogskoleprovet/strategier/kvantitativa-fallor`, scroll to bottom — should show 4 recent test cards + "Se alla prov" link instead of generic CTA
    2. Click a test link, verify navigation to test detail page
    3. Click "Se alla prov →", verify navigation to /hogskoleprovet
    4. Repeat for all 4 strategy pages
  </verify>
  <done>
    All 4 strategy pages show RecentTests component with 4 specific test links and a "Se alla prov" fallback link. No generic CTA remains.
  </done>
</task>

</tasks>

<verification>
1. Test page `/hogskoleprovet/hosten-2025` has "Lär dig strategier" section with 4 strategy links
2. All 4 strategy pages show RecentTests with 4 specific test cards
3. Every link navigates correctly (no 404s)
4. Visual styling consistent with existing RelatedTests component
</verification>

<success_criteria>
- LINK-01: Test detail pages link to all 4 strategy content pages
- LINK-02: Strategy pages link to 4 specific recent tests with "Se alla prov" fallback
- All bidirectional links resolve to live pages
</success_criteria>

<output>
After completion, create `.planning/phases/07-gap-closure-link-integrity/07-03-SUMMARY.md`
</output>
